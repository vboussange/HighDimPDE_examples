%!TEX program = lualatex

\documentclass[a4paper,12pt]{article}
%%%% AMPERSAND FOR REFERENCES

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{amsthm,amsmath,amssymb,mathrsfs,bbm,geometry,epsfig,hyperref,comment,nicefrac,listings,graphicx,color,relsize}
\usepackage{makecell}
\usepackage[inline,shortlabels]{enumitem}
\usepackage[capitalise,noabbrev,sort]{cleveref}
% serial comma clever ref
\newcommand{\creflastconjunction}{, and\nobreakspace}
\crefname{subsection}{Subsection}{Subsections}
\crefname{equation}{}{}
\crefname{enumi}{item}{items}


\hypersetup{colorlinks=true}


%%%%%%%%%%%
%%%%%%%%%%

\renewcommand{\lstlistingname}{{\sc Python} code}
\renewcommand{\lstlistlistingname}{{\sc Python} codes}

\geometry{a4paper,left=24mm,right=24mm}
\lstset{
  language=Python,
  showspaces=false,
  showstringspaces=false,
  basicstyle=\footnotesize\ttfamily,
  numberstyle=\tiny,
  captionpos=b,
  abovecaptionskip=\bigskipamount,
  numbers=left,
  numbersep=8pt,
  frame=single,
  xleftmargin=.25in,
  xrightmargin=.25in,
  captionpos=b,
  abovecaptionskip=\bigskipamount,
  numbers=left,
  numbersep=8pt,
  frame=single,
  xleftmargin=.25in,
  xrightmargin=.10in
}

%%%% TIKZ for neural network
% ARNULF architecture
\usepackage{tikz}
\usetikzlibrary{matrix,chains,positioning,decorations.pathreplacing,arrows}
\usetikzlibrary{shapes,arrows}
\tikzset{
  font={\fontsize{9pt}{12}\selectfont}}
\usepackage{adjustbox}
\def\layersep{3cm}

%https://tex.stackexchange.com/questions/153957/drawing-neural-network-with-tikz
\usepackage{etoolbox} % for \ifnumcomp
\usepackage{listofitems} % for \readlist to create arrays
\tikzset{>=latex} % for LaTeX arrow head
\colorlet{myred}{red!80!black}
\colorlet{myblue}{blue!80!black}
\colorlet{mygreen}{green!60!black}
\colorlet{mydarkred}{myred!40!black}
\colorlet{mydarkblue}{myblue!40!black}
\colorlet{mydarkgreen}{mygreen!40!black}
\tikzstyle{node}=[very thick,circle,draw=myblue,minimum size=22,inner sep=0.5,outer sep=0.6]
\tikzstyle{connect}=[->,thick,mydarkblue,shorten >=1]
\tikzset{ % node styles, numbered for easy mapping with \nstyle
  node 1/.style={node,mydarkgreen,draw=mygreen,fill=mygreen!25},
  node 2/.style={node,mydarkblue,draw=myblue,fill=myblue!20},
  node 3/.style={node,mydarkred,draw=myred,fill=myred!20},
}
\def\nstyle{int(\lay<\Nnodlen?min(2,\lay):3)} % map layer number onto 1, 2, or 3

%% table
\usepackage{multirow, makecell}

%%%% EDITING
\usepackage{soul,color}

\newtheorem{lemma}{Lemma}[section]
\newtheorem{remark}[lemma]{Remark}
\newtheorem{proposition}[lemma]{Proposition}
\newtheorem{theorem}[lemma]{Theorem}
\newtheorem{example}[lemma]{Example}
\newtheorem{definition}[lemma]{Definition}
\newtheorem{prop}[lemma]{Proposition}
\newtheorem{corollary}[lemma]{Corollary}
\newtheorem{assumption}[lemma]{Assumption}
\newtheorem{algo}[lemma]{Framework}
\newtheorem{setting}[lemma]{Setting}

\DeclareMathOperator{\Hess}{Hess}
\DeclareMathOperator{\Trace}{Trace}
\DeclareMathOperator{\cost}{Cost}
\newcommand{\uniform}{\ensuremath{\mathcal{R}}}
\newcommand{\sign}{\ensuremath{\operatorname{sign}}}
\newcommand{\smallsum}{\textstyle\sum}
\DeclareMathOperator*{\smallsuml}{\textstyle\sum}
\DeclareMathOperator*{\smallprodl}{\textstyle\prod}
\providecommand{\1}{\mathbbm{1}}
\providecommand{\N}{\mathbb{N}}
\providecommand{\Z}{\mathbb{Z}}
\providecommand{\R}{\mathbb{R}}
\providecommand{\B}{\mathcal{B}}
\providecommand{\C}{\mathbb{C}}
\renewcommand{\P}{\mathbb{P}}
\providecommand{\bG}{\mathbb{G}}
\providecommand{\bS}{\mathbb{S}}
\providecommand{\cR}{\mathcal{R}}
\renewcommand{\S}{\mathcal{S}}
\providecommand{\sS}{S}
\providecommand{\D}{D}
\providecommand{\dD}{\mathbbm{D}}
\providecommand{\E}{\mathbbm{E}}
\newcommand{\Var}{\operatorname{Var}}
\providecommand{\bV}{{\ensuremath{\mathbb{V}}}}
\providecommand{\bX}{{\ensuremath{\mathbbm{X}}}}
\providecommand{\E}{{\ensuremath{\mathbb{E}}}}
\newcommand{\F}{{\ensuremath{\mathcal{F}}}}
\newcommand{\bF}{{\ensuremath{\mathbb{F}}}}
\newcommand{\Lip}{{\ensuremath{\operatorname{Lip}}}}
\newcommand{\funcF}{F}
\newcommand{\LipConst}{L}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\cN}{\mathcal{N}}
% \newcommand{\G}{\mathcal{G}}
\newcommand{\A}{\mathcal{A}}
% \newcommand{\U}{\mathcal{U}}
\newcommand{\V}{\mathcal{V}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\Y}{\mathcal{Y}}
\newcommand{\cZ}{\mathcal{Z}}
%\newcommand{\norm}[1]{ \left\| #1 \right\| }
\newcommand{\Zz}{Z}
\newcommand{\Rr}{{\ensuremath{\mathcal{V}}}}
\renewcommand{\d}{\mathrm{d}}
\newcommand{\diff}{\mathrm{d}}

\newcommand{\bcup}{\bigcup}

\newcommand{\Borel}{\mathcal{B}}

\newenvironment{approxtabular}{
	\tabular{|r|c|c|c|c|c|c|c|c|}
		\hline
		\multirowcell{4}{$d$}
		& \multirowcell{4}{$T$}
		& \multirowcell{4}{$N$}
		& \multirowcell{4}{Mean\\ of the\\ approx.\\ method } 
		& \multirowcell{4}{Standard\\ deviation of \\ the approx.\\ method } 
		& \multirowcell{4}{Reference \\ value } 
		& \multirowcell{4}{Relative\\$L^1$-approx.\\ error } 
		& \multirowcell{4}{Standard\\ deviation \\ of the \\ error } 
		& \multirowcell{4}{Average\\ runtime \\ in \\ seconds } \\
		&&&&&&&&\\
		&&&&&&&&\\
		&&&&&&&&\\
		\hline
}{
	\hline
	\endtabular
}


% DELIMITERS

\usepackage{mathtools}

\DeclarePairedDelimiter{\pr}()
\DeclarePairedDelimiter{\br}[]
\DeclarePairedDelimiter{\cu}\{\}
\DeclarePairedDelimiter{\abs}\lvert\rvert
\DeclarePairedDelimiter{\norm}\lVert\rVert
\DeclarePairedDelimiter{\ang}\langle\rangle

\newcommand{\bpr}[1]{\pr[\big]{#1}}
\newcommand{\bbpr}[1]{\pr[\Big]{#1}}
\newcommand{\bbbpr}[1]{\pr[\bigg]{#1}}
\newcommand{\bbbbpr}[1]{\pr[\Bigg]{#1}}
\newcommand{\bbr}[1]{\br[\big]{#1}}
\newcommand{\bbbr}[1]{\br[\Big]{#1}}
\newcommand{\bbbbr}[1]{\br[\bigg]{#1}}
\newcommand{\bbbbbr}[1]{\br[\Bigg]{#1}}
\newcommand{\bcu}[1]{\cu[\big]{#1}}
\newcommand{\bbcu}[1]{\cu[\Big]{#1}}
\newcommand{\bbbcu}[1]{\cu[\bigg]{#1}}
\newcommand{\bbbbcu}[1]{\cu[\Bigg]{#1}}
\newcommand{\babs}[1]{\abs[\big]{#1}}
\newcommand{\bbabs}[1]{\abs[\Big]{#1}}
\newcommand{\bbbabs}[1]{\abs[\bigg]{#1}}
\newcommand{\bbbbabs}[1]{\abs[\Bigg]{#1}}
\newcommand{\bnorm}[1]{\norm[\big]{#1}}
\newcommand{\bbnorm}[1]{\norm[\Big]{#1}}
\newcommand{\bbbnorm}[1]{\norm[\bigg]{#1}}
\newcommand{\bbbbnorm}[1]{\norm[\Bigg]{#1}}
\newcommand{\bang}[1]{\ang[\big]{#1}}
\newcommand{\bbang}[1]{\ang[\Big]{#1}}
\newcommand{\bbbang}[1]{\ang[\bigg]{#1}}
\newcommand{\bbbbang}[1]{\ang[\Bigg]{#1}}

\newcommand{\Index}{\mathfrak{I}}
\newcommand{\dindex}{\mathfrak{i}}

\begin{document}
\section{Number of one-dimensional standard normal random variables used by the ML-based approximation method}
% \begin{equation}
%   \label{eq:loss_general_case}
%   \begin{split}
%     %\begin{split}
%     & \phi^{n,m,\mathbf{s}}(\theta,\omega)
%     =
%     \frac{1}{J_m}\sum_{j=1}^{J_m}
%     \bbbbbr{
%     \bV^{j,\mathbf{s}}_n\bpr{\theta,\Y^{n,m,j}_{N-n}(\omega)}
%     -
%     \bV^{j,\mathbf{s}}_{n-1}\bpr{\Theta^{n-1}_{M_{n-1}}(\omega),\Y^{n,m,j}_{N-n+1}(\omega)}\\
%     & - \tfrac{(t_n-t_{n-1})}{K_n} \bbbbr{ \textstyle \sum \limits_{k=1}^{K_n}  f\bbpr{t_{n-1},
%     %& \quad \quad \cdot
%     \Y^{n,m,j}_{N-n+1}(\omega),
%     Z_{ \mathcal{Y}^{n,m,j}_{ N - n + 1 }(\omega), k }^{ n, m,j }(\omega),\\
%     & \bV^{j,\mathbf{s}}_{n-1}\bpr{\Theta^{n-1}_{M_{n-1}}(\omega),\Y^{n,m,j}_{N-n+1}(\omega)},
%     \bV^{j,\mathbf{s}}_{n-1}\bpr{\Theta^{n-1}_{M_{n-1}}(\omega),	Z_{ \mathcal{Y}^{n,m,j}_{ N - n + 1 }(\omega), k }^{ n, m,j }(\omega)}
%     %,\\
%     %& (\nabla_x \bV^{j,\mathbf{s}}_{n-1})\bpr{\Theta^{n-1}_{M_{n-1}}(\omega),\Y^{n,m,j}_{N-n+1}(\omega)},
%     %(\nabla_x \bV^{j,\mathbf{s}}_{n-1})\bpr{\Theta^{n-1}_{M_{n-1}}(\omega),Z_{ \mathcal{Y}^{n,m,j}_{ N - n + 1 }, k }^{ n, m,j }(\omega)}
%     }}
%     }^2,
%     % \\
%     %& = \Big| \bV^{j,\mathbf{s}}_n\bpr{\theta,\Y^{n,m}_{N-n}(\omega)} - \mathfrak{V}^{n,\Theta^{n-1}_{M_{n-1}}(\omega)}\bpr{\Y^{n,m}_{N-n+1}(\omega)} \Big|^2,
%     %\end{split}
%   \end{split}
% \end{equation}
% \begin{comment}
  (here we consider the case where $\xi^{n,m,j} = (0,\dots,0)$)
  \begin{equation}
    \sum_{n=1}^N % number of time steps
    \sum_{m=1}^M % number of iterations
     \sum_{j=1}^{J_m} % batch size
    \sum_{t=1}^{n} d % number of rand. vars eval. for stochastic process 
    + \sum_{n=1}^N % number of time steps
    \sum_{m=1}^M % number of iterations
    \sum_{j=1}^{J_m} % batch size
    \sum_{k=1}^K d % monte carlo integration of the non-local term
  \end{equation}
% \end{comment}

\section{Number of one-dimensional standard normal random variables used by the MLP method}
% \begin{equation}
% 	\label{setting:MLP}
% 	\begin{split}
% 		&
% 		U^\dindex_{n,M,r}(t,x) 
% 		= 
% 		\Biggl[\sum_{l=0}^{n-1} \frac{(T-t)}{M^{n-l}}  
% 		\sum_{m=1}^{M^{n-l}} \frac{1}{K_{n,l,m}}
% 		\sum_{k=1}^{K_{n,l,m}}
% 		\bbbbr{ f \bbpr{
% 				V_t^{(\dindex,l,m)},
% 				X^{x,(\dindex,l,m)}_{t,V_t^{(\dindex,l,m)}},
% 				\Zz^{(\dindex,l,m,k) }_{ X^{x,(\dindex,l,m)}_{t,V_t^{(\dindex,l,m)}} },\\
% 			&\quad 
% 				\phi_{r}\bbpr{U^{(\dindex,l,m)}_{l,M,r}\bpr{V_t^{(\dindex,l,m)},X^{x,(\dindex,l,m)}_{t,V_t^{(\dindex,l,m)}}}},
% 				\phi_{r}\bbpr{U^{(\dindex,l,m)}_{l,M,r}\bpr{V_t^{(\dindex,l,m)},\Zz^{(\dindex,l,m,k) }_{ X^{x,(\dindex,l,m)}_{t,V_t^{(\dindex,l,m)}}}}}
% 			} \\
% 			&\quad- \mathbbm{1}_\N(l) \, f \bbpr{
% 				V_t^{(\dindex,l,m)},
% 				X^{x,(\dindex,l,m)}_{t,V_t^{(\dindex,l,m)}}, 
% 				\Zz^{(\dindex,l,m,k)}_{ X^{x,(\dindex,l,m)}_{t,V_t^{(\dindex,l,m)}} },
% 				\phi_{r}\bbpr{U^{(\dindex,l,-m)}_{\max\{l-1,0\},M,r}\bpr{V_t^{(\dindex,l,m)},X^{x,(\dindex,l,m)}_{t,V_t^{(\dindex,l,m)}}}},\\
% 			&\quad 
% 				\phi_{r}\bbpr{U^{(\dindex,l,-m)}_{\max\{l-1,0\},M,r}\bpr{V_t^{(\dindex,l,m)},\Zz^{(\dindex,l,m,k) }_{ X^{x,(\dindex,l,m)}_{t,V_t^{(\dindex,l,m)}} }}}
% 			}}\Biggr] 
% 			+  
% 			\frac{\1_{\N}(n)}{M^n} \bbbbbr{\sum_{m=1}^{M^n} g\bpr{X^{x,(\dindex,0,-m)}_{t,T}}  },
% 	\end{split}
% \end{equation}
% \begin{comment}
\begin{equation}
	\begin{split}
    f(n,M) &= \sum_{l=0}^{n-1}
		\sum_{m=1}^{M^{n-l}}\left[
    d % X
    + f(l,m)
    + \mathbbm{1}_\N(l) f(l-1,m)\right] \\
    &\quad +
    \sum_{l=0}^{n-1}
		\sum_{m=1}^{M^{n-l}} 
		\sum_{k=1}^{K_{n,l,m}}\left[
		d
    + f(l,m)
    + \mathbbm{1}_\N(l) f(l-1,m)\right] +
    + \mathbbm{1}_\N(n) \sum_{m=1}^{M^n} d
	\end{split}
\end{equation}
% \end{comment}
\end{document}